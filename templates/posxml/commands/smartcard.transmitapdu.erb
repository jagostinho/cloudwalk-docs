<% content_for :docs_description do %>
  <meta name="docs:description" content="<%= I18n.t('posxml.commands.smartcard_transmitapdu.description') %>">
<% end %>

<h1><%= I18n.t("posxml.commands.title") %> <em>smartcard.transmitAPDU</em></h1>

<p class="more-info"><%= I18n.t("general.updated_at", :date => "16/09/2013") %></p>

<p><%= I18n.t("posxml.commands.smartcard_transmitapdu.paragraph_1") %></p>

<p><%= I18n.t("posxml.commands.smartcard_transmitapdu.paragraph_2") %></p>

<h2><%= I18n.t("posxml.commands.parameters") %></h2>

<ol class="parameters">
  <li><%= I18n.t("posxml.commands.smartcard_transmitapdu.parameters.parameter_1") %></li>
  <li><%= I18n.t("posxml.commands.smartcard_transmitapdu.parameters.parameter_2") %></li>
  <li><%= I18n.t("posxml.commands.smartcard_transmitapdu.parameters.parameter_3") %></li>
  <li><%= I18n.t("posxml.commands.smartcard_transmitapdu.parameters.parameter_4") %></li>
  <li><%= I18n.t("posxml.commands.smartcard_transmitapdu.parameters.parameter_5") %></li>
  <li><%= I18n.t("posxml.commands.smartcard_transmitapdu.parameters.parameter_6") %></li>
  <li><%= I18n.t("posxml.commands.smartcard_transmitapdu.parameters.parameter_7") %></li>
  <li><%= I18n.t("posxml.commands.smartcard_transmitapdu.parameters.parameter_8") %></li>
</ol>

<h2><%= I18n.t("posxml.commands.example") %></h2>

<pre><code data-language="html">&lt;integervariable value="0" variable="iReturn" /&gt;

&lt;stringvariable value="" variable="sRet" /&gt;
&lt;stringvariable value="" variable="sDatafiled" /&gt;
&lt;stringvariable value="" variable="sSw" /&gt;

&lt;!-- loop ate que um smartcard seja inserido --&gt;
&lt;while variable="$(iReturn)" operator="notequalto" value="1"&gt;
  &lt;display column="0" line="0" message="INSERT SMARTCARD"&gt;
  &lt;wait milisecond="500"/&gt;
  &lt;smartcard.insertedcard slot="1" variablereturn="$(iReturn)"/&gt;
&lt;/while&gt;


&lt;!-- Inicia o slot 1 do leitor e tenta iniciar o cartão enviando um comando ATR --&gt;
&lt;smartcard.startreader slot="1" variablereturn="$(iReturn)"/&gt;

&lt;!-- Faz uma verificação para ver se tudo ocorreu bem, 1 = sucesso--&gt;
&lt;if variable="$(iReturn)" operator="notequalto" value="1"&gt;
  &lt;cleandisplay/&gt;
  &lt;display column="0" line="0" message="ERRO TRYING"&gt;
  &lt;display column="0" line="1" message="START READER"&gt;
  &lt;display column="0" line="2" message="OR SMARTCARD"&gt;
&lt;/if&gt;

&lt;smartcard.transmitAPDU slot="1" header="00B4030000" LC="00" datafield="00" LE="10" variabledatafieldresponse="$(sDatafiled)" variableSW="$(sSw)" variablereturn="$(iReturn)"/&gt;


&lt;inttostring variableinteger="$(iReturn)" variablestring="$(sRet)" /&gt;

&lt;display column="0" line="0" message="$(sRet)"/&gt;
&lt;display column="0" line="1" message="$(sDatafiled)"/&gt;
&lt;display column="0" line="2" message="$(sSw)"/&gt;
&lt;waitkey /&gt;

&lt;smartcard.closereader slot="1" variablereturn="$(iReturn)"/&gt;

</code></pre>
<hr/>

<p><%= I18n.t("posxml.commands.smartcard_transmitapdu.paragraph_3") %></p>
<p><%= I18n.t("posxml.commands.smartcard_transmitapdu.paragraph_4") %></p>
